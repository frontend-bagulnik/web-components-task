(()=>{var t={5:()=>{class t extends HTMLElement{connectedCallback(){this.shadow=this.attachShadow({mode:"closed"}),this.shadow.innerHTML=this.render()}render(){return"\n        <style>\n            main {\n                padding: 32px 40px;\n                display: flex;\n                flex-direction: column;\n                gap: 16px;  \n            }\n        </style>\n        \n        <main>\n            <slot></slot>\n        </main>"}}customElements.define("default-main-layout",t)},56:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},72:t=>{"use strict";var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var s={},o=[],a=0;a<t.length;a++){var l=t[a],c=r.base?l[0]+r.base:l[0],h=s[c]||0,u="".concat(c," ").concat(h);s[c]=h+1;var d=n(u),f={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(f);else{var p=i(f,r);r.byIndex=a,e.splice(a,0,{identifier:u,updater:p,references:1})}o.push(u)}return o}function i(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var s=r(t=t||[],i=i||{});return function(t){t=t||[];for(var o=0;o<s.length;o++){var a=n(s[o]);e[a].references--}for(var l=r(t,i),c=0;c<s.length;c++){var h=n(s[c]);0===e[h].references&&(e[h].updater(),e.splice(h,1))}s=l}}},113:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},137:()=>{class t extends HTMLElement{connectedCallback(){this.innerHTML=this.render(),this.container=this.querySelector(".placeholderContainer"),this.setVisibility("true"===this.getAttribute("visible"))}static get observedAttributes(){return["visible"]}attributeChangedCallback(t,e,n){"visible"===t&&this.container&&this.setVisibility("true"===n)}setVisibility(t){t?this.container.classList.remove("hidden"):this.container.classList.add("hidden")}render(){return'\n        <style>\n            .placeholderContainer {\n                display: flex;\n                min-height: 150px;\n                align-items: center;\n                justify-content: center;\n                flex-direction: column;\n                gap: 4px;\n             }\n             \n             .hidden {\n                display: none;\n             }\n     \n             .placeholderText {\n                color: var(--gray20)\n             }\n        </style>\n        <div class="placeholderContainer hidden">\n            <span class="placeholderText">Буферный контейнер пуст</span>\n            <span class="placeholderText">Создайте или перенесите полигоны из рабочей зоны</span>\n        </div>'}}customElements.define("buffer-empty-placeholder",t)},218:(t,e,n)=>{"use strict";n(973),n(248);function r(t,e){var n=t.length,r=t.length-e.length,i=Math.min;if(r)return r;switch(n){case 0:return 0;case 1:return t[0]-e[0];case 2:return(a=t[0]+t[1]-e[0]-e[1])||i(t[0],t[1])-i(e[0],e[1]);case 3:var s=t[0]+t[1],o=e[0]+e[1];if(a=s+t[2]-(o+e[2]))return a;var a,l=i(t[0],t[1]),c=i(e[0],e[1]);return(a=i(l,t[2])-i(c,e[2]))||i(l+t[2],s)-i(c+e[2],o);default:var h=t.slice(0);h.sort();var u=e.slice(0);u.sort();for(var d=0;d<n;++d)if(r=h[d]-u[d])return r;return 0}}e.Fw=r},221:(t,e,n)=>{"use strict";t.exports=function(t){var e=r(t),n=e.length;if(n<=2)return[];for(var i=new Array(n),s=e[n-1],o=0;o<n;++o){var a=e[o];i[o]=[s,a],s=a}return i};var r=n(291)},248:t=>{"use strict";function e(t){this.roots=new Array(t),this.ranks=new Array(t);for(var e=0;e<t;++e)this.roots[e]=e,this.ranks[e]=0}t.exports=e;var n=e.prototype;Object.defineProperty(n,"length",{get:function(){return this.roots.length}}),n.makeSet=function(){var t=this.roots.length;return this.roots.push(t),this.ranks.push(0),t},n.find=function(t){for(var e=t,n=this.roots;n[t]!==t;)t=n[t];for(;n[e]!==t;){var r=n[e];n[e]=t,e=r}return t},n.link=function(t,e){var n=this.find(t),r=this.find(e);if(n!==r){var i=this.ranks,s=this.roots,o=i[n],a=i[r];o<a?s[n]=r:a<o?s[r]=n:(s[r]=n,++i[n])}}},291:(t,e,n)=>{"use strict";t.exports=function(t){var e=t.length;if(e<3){for(var n=new Array(e),i=0;i<e;++i)n[i]=i;return 2===e&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]?[0]:n}var s=new Array(e);for(i=0;i<e;++i)s[i]=i;s.sort(function(e,n){return t[e][0]-t[n][0]||t[e][1]-t[n][1]});var o=[s[0],s[1]],a=[s[0],s[1]];for(i=2;i<e;++i){for(var l=s[i],c=t[l],h=o.length;h>1&&r(t[o[h-2]],t[o[h-1]],c)<=0;)h-=1,o.pop();for(o.push(l),h=a.length;h>1&&r(t[a[h-2]],t[a[h-1]],c)>=0;)h-=1,a.pop();a.push(l)}n=new Array(a.length+o.length-2);for(var u=0,d=(i=0,o.length);i<d;++i)n[u++]=o[i];for(var f=a.length-2;f>0;--f)n[u++]=a[f];return n};var r=n(573)[3]},297:(t,e,n)=>{"use strict";var r=n(383),i=n(519);t.exports=function(t,e){var n=t.length;if(1===n){var s=r(t[0],e);return s[0]?s:[s[1]]}var o=new Array(2*n),a=[.1,.1],l=[.1,.1],c=0;r(t[0],e,a),a[0]&&(o[c++]=a[0]);for(var h=1;h<n;++h){r(t[h],e,l);var u=a[1];i(u,l[0],a),a[0]&&(o[c++]=a[0]);var d=l[1],f=a[1],p=d+f,v=f-(p-d);a[1]=p,v&&(o[c++]=v)}return a[1]&&(o[c++]=a[1]),0===c&&(o[c++]=0),o.length=c,o}},314:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n}).join("")},e.i=function(t,n,r,i,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(r)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(o[l]=!0)}for(var c=0;c<t.length;c++){var h=[].concat(t[c]);r&&o[h[0]]||(void 0!==s&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=s),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),i&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=i):h[4]="".concat(i)),e.push(h))}},e}},383:t=>{"use strict";t.exports=function(t,n,r){var i=t*n,s=e*t,o=s-(s-t),a=t-o,l=e*n,c=l-(l-n),h=n-c,u=a*h-(i-o*c-a*c-o*h);return r?(r[0]=u,r[1]=i,r):[u,i]};var e=+(Math.pow(2,27)+1)},503:(t,e,n)=>{"use strict";t.exports=function(t,e){var n=t.length;if(0===n)throw new Error("Must have at least d+1 points");var i=t[0].length;if(n<=i)throw new Error("Must input at least d+1 points");var o=t.slice(0,i+1),a=r.apply(void 0,o);if(0===a)throw new Error("Input not in general position");for(var l=new Array(i+1),h=0;h<=i;++h)l[h]=h;a<0&&(l[0]=1,l[1]=0);var u=new s(l,new Array(i+1),!1),d=u.adjacent,f=new Array(i+2);for(h=0;h<=i;++h){for(var p=l.slice(),v=0;v<=i;++v)v===h&&(p[v]=-1);var g=p[0];p[0]=p[1],p[1]=g;var m=new s(p,new Array(i+1),!0);d[h]=m,f[h]=m}for(f[i+1]=u,h=0;h<=i;++h){p=d[h].vertices;var y=d[h].adjacent;for(v=0;v<=i;++v){var b=p[v];if(b<0)y[v]=u;else for(var x=0;x<=i;++x)d[x].vertices.indexOf(b)<0&&(y[v]=d[x])}}var w=new c(i,o,f),E=!!e;for(h=i+1;h<n;++h)w.insert(t[h],E);return w.boundary()};var r=n(573),i=n(218).Fw;function s(t,e,n){this.vertices=t,this.adjacent=e,this.boundary=n,this.lastVisited=-1}function o(t,e,n){this.vertices=t,this.cell=e,this.index=n}function a(t,e){return i(t.vertices,e.vertices)}s.prototype.flip=function(){var t=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=t;var e=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=e};var l=[];function c(t,e,n){this.dimension=t,this.vertices=e,this.simplices=n,this.interior=n.filter(function(t){return!t.boundary}),this.tuple=new Array(t+1);for(var i=0;i<=t;++i)this.tuple[i]=this.vertices[i];var s=l[t];s||(s=l[t]=function(t){for(var e=["function orient(){var tuple=this.tuple;return test("],n=0;n<=t;++n)n>0&&e.push(","),e.push("tuple[",n,"]");e.push(")}return orient");var i=new Function("test",e.join("")),s=r[t+1];return s||(s=r),i(s)}(t)),this.orient=s}var h=c.prototype;h.handleBoundaryDegeneracy=function(t,e){var n=this.dimension,r=this.vertices.length-1,i=this.tuple,s=this.vertices,o=[t];for(t.lastVisited=-r;o.length>0;){(t=o.pop()).vertices;for(var a=t.adjacent,l=0;l<=n;++l){var c=a[l];if(c.boundary&&!(c.lastVisited<=-r)){for(var h=c.vertices,u=0;u<=n;++u){var d=h[u];i[u]=d<0?e:s[d]}var f=this.orient();if(f>0)return c;c.lastVisited=-r,0===f&&o.push(c)}}}return null},h.walk=function(t,e){var n=this.vertices.length-1,r=this.dimension,i=this.vertices,s=this.tuple,o=e?this.interior.length*Math.random()|0:this.interior.length-1,a=this.interior[o];t:for(;!a.boundary;){for(var l=a.vertices,c=a.adjacent,h=0;h<=r;++h)s[h]=i[l[h]];for(a.lastVisited=n,h=0;h<=r;++h){var u=c[h];if(!(u.lastVisited>=n)){var d=s[h];s[h]=t;var f=this.orient();if(s[h]=d,f<0){a=u;continue t}u.boundary?u.lastVisited=-n:u.lastVisited=n}}return}return a},h.addPeaks=function(t,e){var n=this.vertices.length-1,r=this.dimension,i=this.vertices,l=this.tuple,c=this.interior,h=this.simplices,u=[e];e.lastVisited=n,e.vertices[e.vertices.indexOf(-1)]=n,e.boundary=!1,c.push(e);for(var d=[];u.length>0;){var f=(e=u.pop()).vertices,p=e.adjacent,v=f.indexOf(n);if(!(v<0))for(var g=0;g<=r;++g)if(g!==v){var m=p[g];if(m.boundary&&!(m.lastVisited>=n)){var y=m.vertices;if(m.lastVisited!==-n){for(var b=0,x=0;x<=r;++x)y[x]<0?(b=x,l[x]=t):l[x]=i[y[x]];if(this.orient()>0){y[b]=n,m.boundary=!1,c.push(m),u.push(m),m.lastVisited=n;continue}m.lastVisited=-n}var w=m.adjacent,E=f.slice(),M=p.slice(),C=new s(E,M,!0);h.push(C);var L=w.indexOf(e);if(!(L<0))for(w[L]=C,M[v]=m,E[g]=-1,M[g]=e,p[g]=C,C.flip(),x=0;x<=r;++x){var T=E[x];if(!(T<0||T===n)){for(var S=new Array(r-1),A=0,P=0;P<=r;++P){var O=E[P];O<0||P===x||(S[A++]=O)}d.push(new o(S,C,x))}}}}}for(d.sort(a),g=0;g+1<d.length;g+=2){var D=d[g],I=d[g+1],k=D.index,H=I.index;k<0||H<0||(D.cell.adjacent[D.index]=I.cell,I.cell.adjacent[I.index]=D.cell)}},h.insert=function(t,e){var n=this.vertices;n.push(t);var r=this.walk(t,e);if(r){for(var i=this.dimension,s=this.tuple,o=0;o<=i;++o){var a=r.vertices[o];s[o]=a<0?t:n[a]}var l=this.orient(s);l<0||(0!==l||(r=this.handleBoundaryDegeneracy(r,t)))&&this.addPeaks(t,r)}},h.boundary=function(){for(var t=this.dimension,e=[],n=this.simplices,r=n.length,i=0;i<r;++i){var s=n[i];if(s.boundary){for(var o=new Array(t),a=s.vertices,l=0,c=0,h=0;h<=t;++h)a[h]>=0?o[l++]=a[h]:c=1&h;if(c===(1&t)){var u=o[0];o[0]=o[1],o[1]=u}e.push(o)}}return e}},519:t=>{"use strict";t.exports=function(t,e,n){var r=t+e,i=r-t,s=e-i,o=t-(r-i);return n?(n[0]=o+s,n[1]=r,n):[o+s,r]}},540:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},573:(t,e,n)=>{"use strict";var r=n(383),i=n(951),s=n(297),o=n(916);function a(t,e,n,r){return function(n,i,s){var o=t(t(e(i[1],s[0]),e(-s[1],i[0])),t(e(n[1],i[0]),e(-i[1],n[0]))),a=t(e(n[1],s[0]),e(-s[1],n[0])),l=r(o,a);return l[l.length-1]}}function l(t,e,n,r){return function(i,s,o,a){var l=t(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(n(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),n(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),t(n(t(e(s[1],a[0]),e(-a[1],s[0])),i[2]),t(n(t(e(i[1],a[0]),e(-a[1],i[0])),-s[2]),n(t(e(i[1],s[0]),e(-s[1],i[0])),a[2])))),c=t(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),i[2]),t(n(t(e(i[1],a[0]),e(-a[1],i[0])),-o[2]),n(t(e(i[1],o[0]),e(-o[1],i[0])),a[2]))),t(n(t(e(s[1],o[0]),e(-o[1],s[0])),i[2]),t(n(t(e(i[1],o[0]),e(-o[1],i[0])),-s[2]),n(t(e(i[1],s[0]),e(-s[1],i[0])),o[2])))),h=r(l,c);return h[h.length-1]}}function c(t,e,n,r){return function(i,s,o,a,l){var c=t(t(t(n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),o[2]),t(n(t(e(o[1],l[0]),e(-l[1],o[0])),-a[2]),n(t(e(o[1],a[0]),e(-a[1],o[0])),l[2]))),s[3]),t(n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),s[2]),t(n(t(e(s[1],l[0]),e(-l[1],s[0])),-a[2]),n(t(e(s[1],a[0]),e(-a[1],s[0])),l[2]))),-o[3]),n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),s[2]),t(n(t(e(s[1],l[0]),e(-l[1],s[0])),-o[2]),n(t(e(s[1],o[0]),e(-o[1],s[0])),l[2]))),a[3]))),t(n(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(n(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),n(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),-l[3]),t(n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),s[2]),t(n(t(e(s[1],l[0]),e(-l[1],s[0])),-a[2]),n(t(e(s[1],a[0]),e(-a[1],s[0])),l[2]))),i[3]),n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),i[2]),t(n(t(e(i[1],l[0]),e(-l[1],i[0])),-a[2]),n(t(e(i[1],a[0]),e(-a[1],i[0])),l[2]))),-s[3])))),t(t(n(t(n(t(e(s[1],l[0]),e(-l[1],s[0])),i[2]),t(n(t(e(i[1],l[0]),e(-l[1],i[0])),-s[2]),n(t(e(i[1],s[0]),e(-s[1],i[0])),l[2]))),a[3]),t(n(t(n(t(e(s[1],a[0]),e(-a[1],s[0])),i[2]),t(n(t(e(i[1],a[0]),e(-a[1],i[0])),-s[2]),n(t(e(i[1],s[0]),e(-s[1],i[0])),a[2]))),-l[3]),n(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(n(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),n(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),i[3]))),t(n(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),i[2]),t(n(t(e(i[1],a[0]),e(-a[1],i[0])),-o[2]),n(t(e(i[1],o[0]),e(-o[1],i[0])),a[2]))),-s[3]),t(n(t(n(t(e(s[1],a[0]),e(-a[1],s[0])),i[2]),t(n(t(e(i[1],a[0]),e(-a[1],i[0])),-s[2]),n(t(e(i[1],s[0]),e(-s[1],i[0])),a[2]))),o[3]),n(t(n(t(e(s[1],o[0]),e(-o[1],s[0])),i[2]),t(n(t(e(i[1],o[0]),e(-o[1],i[0])),-s[2]),n(t(e(i[1],s[0]),e(-s[1],i[0])),o[2]))),-a[3]))))),h=t(t(t(n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),o[2]),t(n(t(e(o[1],l[0]),e(-l[1],o[0])),-a[2]),n(t(e(o[1],a[0]),e(-a[1],o[0])),l[2]))),i[3]),n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),i[2]),t(n(t(e(i[1],l[0]),e(-l[1],i[0])),-a[2]),n(t(e(i[1],a[0]),e(-a[1],i[0])),l[2]))),-o[3])),t(n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),i[2]),t(n(t(e(i[1],l[0]),e(-l[1],i[0])),-o[2]),n(t(e(i[1],o[0]),e(-o[1],i[0])),l[2]))),a[3]),n(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),i[2]),t(n(t(e(i[1],a[0]),e(-a[1],i[0])),-o[2]),n(t(e(i[1],o[0]),e(-o[1],i[0])),a[2]))),-l[3]))),t(t(n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),s[2]),t(n(t(e(s[1],l[0]),e(-l[1],s[0])),-o[2]),n(t(e(s[1],o[0]),e(-o[1],s[0])),l[2]))),i[3]),n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),i[2]),t(n(t(e(i[1],l[0]),e(-l[1],i[0])),-o[2]),n(t(e(i[1],o[0]),e(-o[1],i[0])),l[2]))),-s[3])),t(n(t(n(t(e(s[1],l[0]),e(-l[1],s[0])),i[2]),t(n(t(e(i[1],l[0]),e(-l[1],i[0])),-s[2]),n(t(e(i[1],s[0]),e(-s[1],i[0])),l[2]))),o[3]),n(t(n(t(e(s[1],o[0]),e(-o[1],s[0])),i[2]),t(n(t(e(i[1],o[0]),e(-o[1],i[0])),-s[2]),n(t(e(i[1],s[0]),e(-s[1],i[0])),o[2]))),-l[3])))),u=r(c,h);return u[u.length-1]}}function h(t){return(3===t?a:4===t?l:c)(i,r,s,o)}var u=h(3),d=h(4),f=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,n){var r,i=(t[1]-n[1])*(e[0]-n[0]),s=(t[0]-n[0])*(e[1]-n[1]),o=i-s;if(i>0){if(s<=0)return o;r=i+s}else{if(!(i<0))return o;if(s>=0)return o;r=-(i+s)}var a=33306690738754716e-32*r;return o>=a||o<=-a?o:u(t,e,n)},function(t,e,n,r){var i=t[0]-r[0],s=e[0]-r[0],o=n[0]-r[0],a=t[1]-r[1],l=e[1]-r[1],c=n[1]-r[1],h=t[2]-r[2],u=e[2]-r[2],f=n[2]-r[2],p=s*c,v=o*l,g=o*a,m=i*c,y=i*l,b=s*a,x=h*(p-v)+u*(g-m)+f*(y-b),w=7771561172376103e-31*((Math.abs(p)+Math.abs(v))*Math.abs(h)+(Math.abs(g)+Math.abs(m))*Math.abs(u)+(Math.abs(y)+Math.abs(b))*Math.abs(f));return x>w||-x>w?x:d(t,e,n,r)}];function p(t){var e=f[t.length];return e||(e=f[t.length]=h(t.length)),e.apply(void 0,t)}function v(t,e,n,r,i,s,o){return function(e,n,a,l,c){switch(arguments.length){case 0:case 1:return 0;case 2:return r(e,n);case 3:return i(e,n,a);case 4:return s(e,n,a,l);case 5:return o(e,n,a,l,c)}for(var h=new Array(arguments.length),u=0;u<arguments.length;++u)h[u]=arguments[u];return t(h)}}!function(){for(;f.length<=5;)f.push(h(f.length));t.exports=v.apply(void 0,[p].concat(f));for(var e=0;e<=5;++e)t.exports[e]=f[e]}()},601:t=>{"use strict";t.exports=function(t){return t[1]}},602:()=>{class t extends HTMLElement{connectedCallback(){this.shadow=this.attachShadow({mode:"open"}),this.shadow.innerHTML=this.render()}render(){return'\n        <style>\n            nav {\n                background-color: var(--white);\n                padding: 14px 28px;\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                border-bottom: 1px solid var(--gray10);\n            }\n        </style>\n        <nav>\n            <slot name="left-element"></slot>\n            <slot></slot>\n            <slot name="right-element"></slot>\n        </nav>\n    '}}customElements.define("app-header-layout",t)},659:t=>{"use strict";var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},689:(t,e,n)=>{"use strict";t.exports=function(t){var e=t.length;if(0===e)return[];if(1===e)return[0];for(var n=t[0].length,r=[t[0]],s=[0],o=1;o<e;++o)if(r.push(t[o]),i(r,n)){if(s.push(o),s.length===n+1)return s}else r.pop();return s};var r=n(573);function i(t,e){for(var n=new Array(e+1),i=0;i<t.length;++i)n[i]=t[i];for(i=0;i<=t.length;++i){for(var s=t.length;s<=e;++s){for(var o=new Array(e),a=0;a<e;++a)o[a]=Math.pow(s+1-i,a);n[s]=o}if(r.apply(void 0,n))return!0}return!1}},707:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var r=n(601),i=n.n(r),s=n(314),o=n.n(s)()(i());o.push([t.id,"html {\n  scroll-behavior: smooth;\n}\n\n*,\n*::before,\n*::after {\n  margin: 0;\n  padding: 0;\n  outline: none;\n  box-sizing: border-box;\n}\n\nbody {\n  font-size: 16px;\n  -webkit-text-size-adjust: 100%;\n  text-rendering: optimizeSpeed;\n  font-weight: 400;\n  line-height: 22px;\n  min-height: 100vh;\n  background-color: var(--gray);\n  overflow: hidden;\n}\n\nimg,\nvideo {\n  display: block;\n  max-width: 100%;\n}\n\niframe,\nbutton {\n  border: 0;\n}\n\ntable {\n  border-spacing: 0;\n}\n\nbutton {\n  cursor: pointer;\n}\n\nfigure {\n  margin: 0;\n}\n\nul {\n  list-style-type: none;\n}\n\np {\n  font-weight: 500;\n  font-size: 14px;\n  line-height: 28px;\n}\n",""]);const a=o},709:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var r=n(601),i=n.n(r),s=n(314),o=n.n(s)()(i());o.push([t.id,":root {\n  --white: #ffffff;\n  --accent10: #9a95cf;\n  --accent20: #beb5f4;\n  --gray: #f6f5f5;\n  --gray10: #E5E5E5;\n  --gray20: #9e9d9d;\n}\n",""]);const a=o},745:(t,e,n)=>{"use strict";t.exports=function(t,e){try{return r(t,!0)}catch(o){var n=i(t);if(n.length<=e)return[];var s=function(t,e){for(var n=t.length,r=new Array(n),i=0;i<e.length;++i)r[i]=t[e[i]];var s=e.length;for(i=0;i<n;++i)e.indexOf(i)<0&&(r[s++]=t[i]);return r}(t,n);return function(t,e){for(var n=t.length,r=e.length,i=0;i<n;++i)for(var s=t[i],o=0;o<s.length;++o){var a=s[o];if(a<r)s[o]=e[a];else{a-=r;for(var l=0;l<r;++l)a>=e[l]&&(a+=1);s[o]=a}}return t}(r(s,!0),n)}};var r=n(503),i=n(689)},825:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},858:t=>{"use strict";t.exports=function(t){for(var e=0,n=0,r=1;r<t.length;++r)t[r][0]<t[e][0]&&(e=r),t[r][0]>t[n][0]&&(n=r);return e<n?[[e],[n]]:e>n?[[n],[e]]:[[e]]}},916:t=>{"use strict";t.exports=function(t,e){var n=0|t.length,r=0|e.length;if(1===n&&1===r)return function(t,e){var n=t+e,r=n-t,i=t-(n-r)+(e-r);return i?[i,n]:[n]}(t[0],-e[0]);var i,s,o=new Array(n+r),a=0,l=0,c=0,h=Math.abs,u=t[l],d=h(u),f=-e[c],p=h(f);d<p?(s=u,(l+=1)<n&&(d=h(u=t[l]))):(s=f,(c+=1)<r&&(p=h(f=-e[c]))),l<n&&d<p||c>=r?(i=u,(l+=1)<n&&(d=h(u=t[l]))):(i=f,(c+=1)<r&&(p=h(f=-e[c])));for(var v,g,m=i+s,y=m-i,b=s-y,x=b,w=m;l<n&&c<r;)d<p?(i=u,(l+=1)<n&&(d=h(u=t[l]))):(i=f,(c+=1)<r&&(p=h(f=-e[c]))),(b=(s=x)-(y=(m=i+s)-i))&&(o[a++]=b),x=w-((v=w+m)-(g=v-w))+(m-g),w=v;for(;l<n;)(b=(s=x)-(y=(m=(i=u)+s)-i))&&(o[a++]=b),x=w-((v=w+m)-(g=v-w))+(m-g),w=v,(l+=1)<n&&(u=t[l]);for(;c<r;)(b=(s=x)-(y=(m=(i=f)+s)-i))&&(o[a++]=b),x=w-((v=w+m)-(g=v-w))+(m-g),w=v,(c+=1)<r&&(f=-e[c]);return x&&(o[a++]=x),w&&(o[a++]=w),a||(o[a++]=0),o.length=a,o}},919:(t,e,n)=>{"use strict";var r=n(858),i=n(221),s=n(745);t.exports=function(t){var e=t.length;if(0===e)return[];if(1===e)return[[0]];var n=t[0].length;return 0===n?[]:1===n?r(t):2===n?i(t):s(t,n)}},951:t=>{"use strict";t.exports=function(t,e){var n=0|t.length,r=0|e.length;if(1===n&&1===r)return function(t,e){var n=t+e,r=n-t,i=t-(n-r)+(e-r);return i?[i,n]:[n]}(t[0],e[0]);var i,s,o=new Array(n+r),a=0,l=0,c=0,h=Math.abs,u=t[l],d=h(u),f=e[c],p=h(f);d<p?(s=u,(l+=1)<n&&(d=h(u=t[l]))):(s=f,(c+=1)<r&&(p=h(f=e[c]))),l<n&&d<p||c>=r?(i=u,(l+=1)<n&&(d=h(u=t[l]))):(i=f,(c+=1)<r&&(p=h(f=e[c])));for(var v,g,m=i+s,y=m-i,b=s-y,x=b,w=m;l<n&&c<r;)d<p?(i=u,(l+=1)<n&&(d=h(u=t[l]))):(i=f,(c+=1)<r&&(p=h(f=e[c]))),(b=(s=x)-(y=(m=i+s)-i))&&(o[a++]=b),x=w-((v=w+m)-(g=v-w))+(m-g),w=v;for(;l<n;)(b=(s=x)-(y=(m=(i=u)+s)-i))&&(o[a++]=b),x=w-((v=w+m)-(g=v-w))+(m-g),w=v,(l+=1)<n&&(u=t[l]);for(;c<r;)(b=(s=x)-(y=(m=(i=f)+s)-i))&&(o[a++]=b),x=w-((v=w+m)-(g=v-w))+(m-g),w=v,(c+=1)<r&&(f=e[c]);return x&&(o[a++]=x),w&&(o[a++]=w),a||(o[a++]=0),o.length=a,o}},973:(t,e)=>{"use strict";function n(t){var e=32;return(t&=-t)&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}e.INT_BITS=32,e.INT_MAX=2147483647,e.INT_MIN=-1<<31,e.sign=function(t){return(t>0)-(t<0)},e.abs=function(t){var e=t>>31;return(t^e)-e},e.min=function(t,e){return e^(t^e)&-(t<e)},e.max=function(t,e){return t^(t^e)&-(t<e)},e.isPow2=function(t){return!(t&t-1||!t)},e.log2=function(t){var e,n;return e=(t>65535)<<4,e|=n=((t>>>=e)>255)<<3,e|=n=((t>>>=n)>15)<<2,(e|=n=((t>>>=n)>3)<<1)|(t>>>=n)>>1},e.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},e.popCount=function(t){return 16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},e.countTrailingZeros=n,e.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,1+(t|=t>>>16)},e.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)-(t>>>1)},e.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,27030>>>(t&=15)&1};var r=new Array(256);!function(t){for(var e=0;e<256;++e){var n=e,r=e,i=7;for(n>>>=1;n;n>>>=1)r<<=1,r|=1&n,--i;t[e]=r<<i&255}}(r),e.reverse=function(t){return r[255&t]<<24|r[t>>>8&255]<<16|r[t>>>16&255]<<8|r[t>>>24&255]},e.interleave2=function(t,e){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))<<1},e.deinterleave2=function(t,e){return(t=65535&((t=16711935&((t=252645135&((t=858993459&((t=t>>>e&1431655765)|t>>>1))|t>>>2))|t>>>4))|t>>>16))<<16>>16},e.interleave3=function(t,e,n){return t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2),(t|=(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<1)|(n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2))<<2},e.deinterleave3=function(t,e){return(t=1023&((t=4278190335&((t=251719695&((t=3272356035&((t=t>>>e&1227133513)|t>>>2))|t>>>4))|t>>>8))|t>>>16))<<22>>22},e.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>n(t)+1}}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var s=e[r]={id:r,exports:{}};return t[r](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0,(()=>{"use strict";const t="CREATE_CLICK",e="CLEAR_CLICK",r="SAVE_CLICK",i=t=>new CustomEvent(t,{bubbles:!0,composed:!0}),s={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let o;const a=new Uint8Array(16),l=[];for(let t=0;t<256;++t)l.push((t+256).toString(16).slice(1));const c=function(t,e,n){if(s.randomUUID&&!e&&!t)return s.randomUUID();const r=(t=t||{}).random??t.rng?.()??function(){if(!o){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");o=crypto.getRandomValues.bind(crypto)}return o(a)}();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){if((n=n||0)<0||n+16>e.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let t=0;t<16;++t)e[n+t]=r[t];return e}return function(t,e=0){return(l[t[e+0]]+l[t[e+1]]+l[t[e+2]]+l[t[e+3]]+"-"+l[t[e+4]]+l[t[e+5]]+"-"+l[t[e+6]]+l[t[e+7]]+"-"+l[t[e+8]]+l[t[e+9]]+"-"+l[t[e+10]]+l[t[e+11]]+l[t[e+12]]+l[t[e+13]]+l[t[e+14]]+l[t[e+15]]).toLowerCase()}(r)};class h{constructor(t,e=c()){this.id=e,this.type=t}draw(t){}getId(){return this.id}getType(){return this.type}}const u={},d=(t,e)=>{u[t]||(u[t]=[]),u[t].push(e)},f=(t,e)=>{u[t]&&u[t].forEach(t=>t(e))},p="ZOOM_IN",v="ZOOM_OUT",g="MOUSE_DOWN",m="MOVE_ELEMENT",y="MOVED_ELEMENT_OUTSIDE",b="RENDER",x="GRID";class w extends h{constructor({id:t,lineWidth:e=1,cellWidth:n=25,cellHeight:r=25,offset:i=0,fontSize:s=8,textOffset:o=25,color:a="#000000"}={}){super(x,t),this.originOptions={cellWidth:n,cellHeight:r},this.options={lineWidth:e,cellWidth:n,cellHeight:r,offset:i,color:a},this.measureOptions={fontSize:s,offset:o},d(p,this.increaseCellSize.bind(this)),d(v,this.decreaseCellSize.bind(this))}increaseCellSize(){const{cellWidth:t,cellHeight:e}=this.originOptions;this.options.cellWidth+=t,this.options.cellHeight+=e}decreaseCellSize(){const{cellWidth:t,cellHeight:e}=this.originOptions;this.options.cellWidth-=t,this.options.cellHeight-=e}draw(t){const{lineWidth:e,color:n}=this.options;t.strokeStyle=n,t.lineWidth=e,this.drawVerticalLines(t),this.drawHorizontalLines(t)}drawVerticalLine(t,e,n,r,i,s){const{offset:o}=this.measureOptions;t.beginPath(),t.moveTo(e,n),t.lineTo(r,i),s&&this.drawMeasureText(t,e,i+o,s),t.stroke()}drawVerticalLines(t){const{cellWidth:e,offset:n}=this.options,r=t.canvas.height-n,i=t.canvas.width-n;for(let s=n;s<=i;s+=e)this.drawVerticalLine(t,s,n,s,r,""+(s-n));this.drawVerticalLine(t,i,n,i,r),this.drawDefaultText(t,""+(i-n),i,r+this.measureOptions.offset)}drawHorizontalLine(t,e,n,r,i,s){const{offset:o}=this.measureOptions;t.beginPath(),t.moveTo(e,n),t.lineTo(r,i),s&&this.drawMeasureText(t,e-o,i,s,!0),t.stroke()}drawHorizontalLines(t){const{cellHeight:e,offset:n}=this.options,{offset:r}=this.measureOptions,i=t.canvas.height-n,s=t.canvas.width-n;for(let r=n;r<i;r+=e)this.drawHorizontalLine(t,n,r,s,r,""+(i-r));this.drawHorizontalLine(t,n,i,s,i,"0")}drawMeasureText(t,e,n,r,i=!1){const{fontSize:s}=this.measureOptions,{width:o}=t.measureText(r),a=i?e:e-o/2,l=i?n+s/2:n;this.drawDefaultText(t,r,a,l)}drawDefaultText(t,e,n,r){const{fontSize:i}=this.measureOptions;t.font=`${i}px serif`,t.strokeText(e,n,r)}}const E={svgPolygonWidth:75,svgPolygonHeight:75,color:"#950227",borderColor:"#45272e",borderWidth:3},M=t=>Array.from(Array(t).keys());var C=n(919),L=n.n(C);const T=(t,e,n)=>{const r=M(t).map(()=>({x:Math.random()*e,y:Math.random()*n})),i=r.map(({x:t,y:e})=>[t,e]);return L()(i).map(([t,e],n)=>0===n?r[t]:r[e])},S=({points:t,id:e=c()}={})=>{const{svgPolygonWidth:n,svgPolygonHeight:r}=E;return{id:e,points:t||T(10,n,r),options:{width:n,height:r}}};class A extends h{constructor({id:t,position:e,points:n,color:r=E.color,borderColor:i=E.borderColor,borderWidth:s=E.borderWidth}){super("POLYGON",t),this.position=e,this.points=n,this.options={color:r,borderColor:i,borderWidth:s}}draw(t){const{x:e,y:n}=this.position,{color:r,borderColor:i,borderWidth:s}=this.options;t.fillStyle=r,t.strokeStyle=i,t.lineWidth=s,t.beginPath(),this.points.forEach(({x:r,y:i})=>{t.lineTo(e+r,n+i)}),t.fill(),t.stroke()}translate(t,e){this.position.x+=t,this.position.y+=e}}const P="SELECTED_ELEMENT",{addSceneElement:O,removeSceneElement:D,getSceneElements:I,getSceneElementById:k,clearScene:H}=(()=>{const t={children:[]};return{addSceneElement:e=>t.children.push(e),removeSceneElement:e=>t.children=t.children.filter(t=>e!==t.getId()),getSceneElements:()=>[...t.children],getSceneElementById:e=>t.children.find(t=>t.getId()===e),clearScene:()=>t.children=t.children.filter(t=>t.getType()===x)}})();d(g,({x:t,y:e})=>{const n=I().filter(n=>((t,e,n)=>{const{points:r,position:i}=n;if(!r||!i)return!1;const s=r.map(({x:t})=>t+i.x),o=r.map(({y:t})=>t+i.y),a=Math.min(...s),l=Math.max(...s),c=Math.min(...o),h=Math.max(...o);return t>=a&&t<=l&&e>=c&&e<=h})(t,e,n));n.length&&f(P,n[0].getId())}),d(m,({id:t,dx:e,dy:n})=>{const r=k(t);r&&r.translate(e,n)});const B="DROP_ELEMENT",N="ELEMENT_DROPPED",W={bufferContainerData:"bufferContainerData",canvasData:"canvasData"},V={POLYGON:A},{getBufferPolygons:j,setBufferPolygons:U,addPolygonToBuffer:z,removePolygonFromBuffer:R}=(()=>{const t={polygons:[]};return{getBufferPolygons:()=>[...t.polygons],setBufferPolygons:e=>t.polygons=e,addPolygonToBuffer:e=>t.polygons.push(e),removePolygonFromBuffer:e=>{t.polygons=t.polygons.filter(({id:t})=>t!==e)}}})(),{loadAppData:$,saveAppData:_,clearAppData:q}={loadAppData:()=>{const t=t=>JSON.parse(t),e=t=>window.localStorage.getItem(t),{bufferContainerData:n,canvasData:r}=W;return{bufferPolygons:t(e(n)),scenePolygons:t(e(r))}},saveAppData:(t,e)=>{const n=(t,e)=>window.localStorage.setItem(t,JSON.stringify(e)),{bufferContainerData:r,canvasData:i}=W;n(r,t),n(i,e)},clearAppData:()=>{const t=t=>window.localStorage.removeItem(t),{bufferContainerData:e,canvasData:n}=W;t(e),t(n)}};class Y extends HTMLElement{constructor(){super(),this.bufferContainer=null}connectedCallback(){this.innerHTML=this.render(),this.initListeners(),this.bufferContainer=this.querySelector("buffer-container");const t=new w({offset:50});O(t);const{bufferPolygons:e,scenePolygons:n}=$();e&&(U(e),this.updateBuffer()),n&&n.forEach(t=>{const e=V[t.type];if(!e)return;const n=new e(t);n&&O(n)})}onPolygonDroppedOnCanvas({detail:t}){!function({x:t,y:e,elementId:n},r){const i=r.find(({id:t})=>t===n);if(!i)return;const{id:s,points:o}=i,a=new A({id:s,position:{x:t,y:e},points:o,borderWidth:E.borderWidth});O(a),f(b)}(t,j()),R(t.elementId),this.updateBuffer()}onPolygonOutOfCanvas({id:t}){this.style.cursor="grab",this.bufferContainer.setIsExpectingElement(t)}onPolygonDroppedToBufferContainer(){const t=k(this.bufferContainer.expectedElementId);t?(z(S(t)),this.updateBuffer(),D(this.bufferContainer.expectedElementId),f(b)):console.error("can't find dropped element from canvas to buffer")}onMouseUp(){this.bufferContainer.isExpectingElement&&(this.bufferContainer.cancelExpectingElement(),this.style.cursor="default")}updateBuffer(){this.bufferContainer.setAttribute("polygons",JSON.stringify(j()))}initListeners(){this.addEventListener(t,t=>{U((()=>{const t=Math.round(15*Math.random()+5);return M(t).map(()=>S())})()),this.updateBuffer()}),this.addEventListener(r,()=>_(j(),I().filter(t=>t.getType()!==x))),this.addEventListener(e,()=>{U([]),H(),q(),this.updateBuffer(),f(b)}),this.addEventListener(B,this.onPolygonDroppedOnCanvas.bind(this)),this.addEventListener(N,this.onPolygonDroppedToBufferContainer.bind(this)),this.addEventListener("mouseup",this.onMouseUp.bind(this)),d(y,this.onPolygonOutOfCanvas.bind(this))}render(){return"\n      <app-header></app-header>\n      <default-main-layout>\n          <buffer-container></buffer-container>    \n          <droppable-canvas></droppable-canvas>    \n      </default-main-layout>\n    "}}customElements.define("app-component",Y);var X=n(72),F=n.n(X),Z=n(825),J=n.n(Z),G=n(659),K=n.n(G),Q=n(56),tt=n.n(Q),et=n(540),nt=n.n(et),rt=n(113),it=n.n(rt),st=n(707),ot={};ot.styleTagTransform=it(),ot.setAttributes=tt(),ot.insert=K().bind(null,"head"),ot.domAPI=J(),ot.insertStyleElement=nt(),F()(st.A,ot),st.A&&st.A.locals&&st.A.locals;var at=n(709),lt={};lt.styleTagTransform=it(),lt.setAttributes=tt(),lt.insert=K().bind(null,"head"),lt.domAPI=J(),lt.insertStyleElement=nt(),F()(at.A,lt),at.A&&at.A.locals&&at.A.locals;class ct extends HTMLElement{connectedCallback(){this.innerHTML=this.render()}get className(){return this.getAttribute("className")}set className(t){return this.setAttribute("className",t)}render(){return`\n        <button class="${this.className}">\n            <slot></slot>\n        </button>`}}customElements.define("base-button",ct),customElements.define("default-button",class extends ct{constructor(){super()}connectedCallback(){this.shadow=this.attachShadow({mode:"closed"}),this.shadow.innerHTML=this.render()}render(){return'\n        <style>\n        .button {\n          background-color: var(--accent10);\n          border: none;\n          font-weight: 600;\n          font-family: inherit;\n          color: var(--white);\n          border-radius: 16px;\n          padding: 12px 24px;\n          font-size: 16px;\n          line-height: 120%;\n        \n          &:hover {\n            cursor: pointer;\n            transition: all ease 0.3s;\n            background-color: var(--accent20);\n          }\n        }\n        \n        </style>\n        \n        <base-button className="button"/>\n    '}}),n(5);class ht extends HTMLElement{constructor(){super(),this.canvas=null,this.ctx=null}init(){this.canvas=this.querySelector("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.style.backgroundColor="white",this.setScale()}setScale(){const t=window.devicePixelRatio||1,e=this.canvas.getBoundingClientRect(),n=e.width*t,r=e.height*t;this.ctx.scale(t,t),this.canvas.style.width=`${n}px`,this.canvas.style.height=`${r}px`}connectedCallback(){this.innerHTML=this.render(),this.init()}render(){const{width:t,height:e}={width:window.innerWidth-80,height:window.innerHeight-64-16-74-150};return`\n        <style>\n            canvas {\n                flex: 1\n                border-radius: 10px;\n                user-select: none;\n            }\n         </style>\n        <canvas width="${t}" height="${e}" draggable="false"></canvas>`}}const ut=(t,{clientX:e,clientY:n},{x:r,y:i,scale:s})=>{const o=t.getBoundingClientRect();return{canvasX:(e-o.left-r)/s,canvasY:(n-o.top-i)/s}};class dt extends ht{constructor(){super(),this.viewportTransform={x:0,y:0,scale:1},this.prevMousePosition={x:0,y:0},this.controls={panning:!0,elementMovement:!1},this.mouseMoveListener=null,this.movingElementId=null}connectedCallback(){super.connectedCallback(),this.initListeners(),this.renderScene()}initListeners(){this.canvas.addEventListener("mousedown",this.onMouseDown.bind(this)),this.canvas.addEventListener("mouseup",this.onMouseUp.bind(this)),this.canvas.addEventListener("mouseout",this.onMouseOut.bind(this)),this.canvas.addEventListener("wheel",this.onMouseWheel.bind(this)),d(b,this.renderScene.bind(this)),d(P,this.onSceneElementSelected.bind(this))}onMouseDown({clientX:t,clientY:e}){this.prevMousePosition.y=e,this.prevMousePosition.x=t;const{canvasX:n,canvasY:r}=ut(this.canvas,{clientX:t,clientY:e},this.viewportTransform);f(g,{x:n,y:r}),this.mouseMoveListener=this.onMouseMove.bind(this),this.canvas.addEventListener("mousemove",this.mouseMoveListener,!1)}onMouseMove({clientX:t,clientY:e}){this.controls.panning&&(this.viewportTransform.x+=t-this.prevMousePosition.x,this.viewportTransform.y+=e-this.prevMousePosition.y),this.movingElementId&&this.controls.elementMovement&&f(m,{id:this.movingElementId,dx:t-this.prevMousePosition.x,dy:e-this.prevMousePosition.y}),this.prevMousePosition.x=t,this.prevMousePosition.y=e,this.renderScene()}onMouseUp(){this.canvas.removeEventListener("mousemove",this.mouseMoveListener,!1),this.resetControls()}onMouseOut(){this.movingElementId&&f(y,{id:this.movingElementId}),this.onMouseUp()}onMouseWheel(t){t.preventDefault();const{clientX:e,clientY:n,deltaY:r}=t,{x:i,y:s,scale:o}=this.viewportTransform,a=-.01*r,l=o+a;if(l<=0)return;const c=(t,e)=>e-l/o*(e-t);this.viewportTransform.x=c(i,e),this.viewportTransform.y=c(s,n),this.viewportTransform.scale=l,f(a>0?p:v),this.renderScene()}onSceneElementSelected(t){this.controls.panning=!1,this.controls.elementMovement=!0,this.movingElementId=t}resetControls(){this.controls.panning=!0,this.controls.elementMovement=!1,this.movingElementId=null}applyTransform(){this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);const{scale:t,x:e,y:n}=this.viewportTransform;this.ctx.setTransform(t,0,0,t,e,n)}renderScene(){this.applyTransform(),I().forEach(t=>t.draw(this.ctx))}}customElements.define("controlled-canvas",dt),customElements.define("droppable-canvas",class extends dt{initListeners(){super.initListeners(),this.canvas.addEventListener("dragover",this.onDragOverElement.bind(this)),this.canvas.addEventListener("drop",this.onDropElement.bind(this))}onDragOverElement(t){t.preventDefault(),t.dataTransfer.dropEffect="move"}onDropElement(t){t.preventDefault();const e=t.dataTransfer.getData("text/plain");if(!e)return;const{canvasX:n,canvasY:r}=ut(this.canvas,t,this.viewportTransform);this.dispatchEvent(((t,e)=>new CustomEvent(t,{composed:!0,bubbles:!0,detail:e}))(B,{elementId:e,x:n,y:r}))}});class ft extends HTMLElement{get height(){return this.getAttribute("height")}set height(t){this.setAttribute("height",t)}get width(){return this.getAttribute("width")}set width(t){this.setAttribute("width",t)}get points(){return this.getAttribute("points")}set points(t){this.setAttribute("points",t)}connectedCallback(){this.innerHTML=this.render(),this.initListeners()}initListeners(){this.querySelector("div")?.addEventListener("dragstart",t=>{t.dataTransfer.setData("text/plain",this.id)})}render(){const{color:t,borderColor:e,borderWidth:n}=E;return`\n     <div draggable="true"> \n        <svg height="${this.height}" width="${this.width}"  xmlns="http://www.w3.org/2000/svg">\n            <polygon points="${this.points}" style="fill:${t};stroke:${e};stroke-width:${n}"></polygon>\n        </svg>\n    </div>\n    `}}customElements.define("polygon-svg",ft),n(602);class pt extends HTMLElement{connectedCallback(){this.innerHTML=this.render(),this.initListeners()}initListeners(){this.querySelector("#createButton")?.addEventListener("click",this.onCreate.bind(this)),this.querySelector("#saveButton")?.addEventListener("click",this.onSave.bind(this)),this.querySelector("#clearButton")?.addEventListener("click",this.onClear.bind(this))}onCreate(){this.dispatchEvent(i(t))}onClear(){this.dispatchEvent(i(e))}onSave(){this.dispatchEvent(i(r))}render(){return'\n        <app-header-layout>\n            <default-button id="createButton">Создать</default-button>\n            <div slot="right-element">\n                <default-button id="saveButton">Сохранить</default-button>\n                <default-button id="clearButton">Сбросить</default-button>\n            </div>\n        </app-header-layout>        \n    '}}customElements.define("app-header",pt);class vt extends HTMLElement{constructor(){super(),this.polygonContainer=null,this.placeholder=null}get polygons(){return this.getAttribute("polygons")}set polygons(t){this.setAttribute("polygons",t),this.onPolygonChanged()}static get observedAttributes(){return["polygons"]}attributeChangedCallback(t,e,n){e!==n&&(this[t]=n)}clearBuffer(){if(this.polygonContainer)for(;this.polygonContainer.firstChild;)this.polygonContainer.removeChild(this.polygonContainer.firstChild)}onPolygonChanged(){if(!this.polygons)return;this.clearBuffer();const t=JSON.parse(this.polygons);t&&(t.length?(t.forEach(t=>{const e=(({id:t,points:e,options:n})=>{const r=(t=>t.map(({x:t,y:e})=>`${t},${e}`).join(" "))(e),i=document.createElement("polygon-svg");return i.id=t,i.points=r,i.width=n.width,i.height=n.height,i})(t);this.polygonContainer.appendChild(e)}),this.placeholder.setAttribute("visible",!1)):this.placeholder.setAttribute("visible",!0))}}customElements.define("buffer-container",class extends vt{constructor(){super(),this.container=null,this.isExpectingElement=!1,this.expectedElementId=null}setIsExpectingElement(t){this.expectedElementId=t,this.isExpectingElement=!0}cancelExpectingElement(){this.expectedElementId=null,this.isExpectingElement=!1}onPolygonDropped(){this.isExpectingElement&&(this.container.classList.remove("dropZone"),this.dispatchEvent(new CustomEvent(N,{composed:!0,bubbles:!0})))}onPolygonOutBuffer(){this.isExpectingElement&&this.container.classList.remove("dropZone")}onPolygonOverBuffer(){this.isExpectingElement&&this.container.classList.add("dropZone")}connectedCallback(){this.innerHTML=this.render(),this.container=this.querySelector(".container"),this.polygonContainer=this.querySelector(".polygonContainer"),this.placeholder=this.querySelector("buffer-empty-placeholder"),this.initListeners()}initListeners(){this.addEventListener("mouseup",this.onPolygonDropped.bind(this)),this.addEventListener("mouseover",this.onPolygonOverBuffer.bind(this)),this.addEventListener("mouseout",this.onPolygonOutBuffer.bind(this))}render(){return`\n        <style>\n            .container {\n                background-color: var(--white);\n                border-radius: 10px;\n                height: 150px;\n                border: 3px solid transparent;\n            }\n\n            .dropZone {\n                border: 3px solid var(--gray10);\n            }\n            \n            .polygonContainer {\n                display: grid;\n                grid-template-columns: repeat(auto-fill, ${E.svgPolygonWidth}px);\n            }\n        </style>\n        \n        <div class="container">\n            <div class="polygonContainer"></div>\n            <buffer-empty-placeholder visible="true"></buffer-empty-placeholder>\n        </div>    \n    `}}),n(137)})()})();